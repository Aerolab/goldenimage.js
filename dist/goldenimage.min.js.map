{"version":3,"sources":["goldenimage.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","Object","defineProperty","value","getOrientation","file","callback","reader","FileReader","onload","e","view","DataView","target","result","getUint16","length","byteLength","offset","marker","getUint32","little","tags","i","readAsArrayBuffer","loadImage","f","options","arguments","undefined","srcOrientation","addEventListener","img","Image","width","height","canvas","document","createElement","ctx","getContext","indexOf","preferedWidth","outputCompression","compression","outputType","transform","drawImage","src","toDataURL","img2","ratio","readAsDataURL","default"],"mappings":"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","file":"goldenimage.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"goldenimage\"] = factory();\n\telse\n\t\troot[\"goldenimage\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar getOrientation = function getOrientation(file, callback) {\n\t  var reader = new FileReader();\n\t  reader.onload = function (e) {\n\t\n\t    var view = new DataView(e.target.result);\n\t    if (view.getUint16(0, false) != 0xFFD8) return callback(-2);\n\t    var length = view.byteLength,\n\t        offset = 2;\n\t    while (offset < length) {\n\t      var marker = view.getUint16(offset, false);\n\t      offset += 2;\n\t      if (marker == 0xFFE1) {\n\t        if (view.getUint32(offset += 2, false) != 0x45786966) return callback(-1);\n\t        var little = view.getUint16(offset += 6, false) == 0x4949;\n\t        offset += view.getUint32(offset + 4, little);\n\t        var tags = view.getUint16(offset, little);\n\t        offset += 2;\n\t        for (var i = 0; i < tags; i++) {\n\t          if (view.getUint16(offset + i * 12, little) == 0x0112) return callback(view.getUint16(offset + i * 12 + 8, little));\n\t        }\n\t      } else if ((marker & 0xFF00) != 0xFF00) break;else offset += view.getUint16(offset, false);\n\t    }\n\t    return callback(-1);\n\t  };\n\t  reader.readAsArrayBuffer(file);\n\t};\n\t\n\tvar loadImage = function loadImage(f) {\n\t  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t  var callback = arguments[2];\n\t\n\t  getOrientation(f, function (srcOrientation) {\n\t    var reader = new FileReader();\n\t    reader.addEventListener('load', function (file) {\n\t      var img = new Image();\n\t      img.onload = function () {\n\t        var width = img.width;\n\t        var height = img.height;\n\t        var canvas = document.createElement('canvas');\n\t        var ctx = canvas.getContext('2d');\n\t\n\t        if ([5, 6, 7, 8].indexOf(srcOrientation) > -1) {\n\t          canvas.width = height;\n\t          canvas.height = width;\n\t        } else {\n\t          canvas.width = width;\n\t          canvas.height = height;\n\t        }\n\t        var preferedWidth = options.width || canvas.width;\n\t        var outputCompression = options.compression || 0.7;\n\t        var outputType = null;\n\t        if (options.compression) {\n\t          outputType = 'image/jpeg';\n\t        }\n\t\n\t        switch (srcOrientation) {\n\t          case 2:\n\t            ctx.transform(-1, 0, 0, 1, width, 0);break;\n\t          case 3:\n\t            ctx.transform(-1, 0, 0, -1, width, height);break;\n\t          case 4:\n\t            ctx.transform(1, 0, 0, -1, 0, height);break;\n\t          case 5:\n\t            ctx.transform(0, 1, 1, 0, 0, 0);break;\n\t          case 6:\n\t            ctx.transform(0, 1, -1, 0, height, 0);break;\n\t          case 7:\n\t            ctx.transform(0, -1, -1, 0, height, width);break;\n\t          case 8:\n\t            ctx.transform(0, -1, 1, 0, 0, width);break;\n\t          default:\n\t            ctx.transform(1, 0, 0, 1, 0, 0);\n\t        }\n\t\n\t        ctx.drawImage(img, 0, 0);\n\t        var src = canvas.toDataURL(outputType, outputCompression);\n\t\n\t        // Resizing\n\t        var img2 = new Image();\n\t        img2.src = src;\n\t        img2.onload = function () {\n\t          var ratio = preferedWidth / canvas.width;\n\t          canvas.width = preferedWidth;\n\t          canvas.height = canvas.height * ratio;\n\t          ctx.drawImage(img2, 0, 0, canvas.width, canvas.height);\n\t          callback(canvas.toDataURL(outputType, outputCompression));\n\t        };\n\t      };\n\t      img.src = file.target.result;\n\t    }, false);\n\t    reader.readAsDataURL(f);\n\t  });\n\t};\n\t\n\texports.default = loadImage;\n\n/***/ }\n/******/ ])\n});\n;\n"],"sourceRoot":"/source/"}