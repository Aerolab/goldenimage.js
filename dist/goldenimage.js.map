{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 602cbc16da6404abd8c4","webpack:///./src/goldenimage.js"],"names":["getOrientation","file","callback","reader","FileReader","onload","e","view","DataView","target","result","getUint16","length","byteLength","offset","marker","getUint32","little","tags","i","readAsArrayBuffer","loadImage","f","options","srcOrientation","addEventListener","img","Image","width","height","canvas","document","createElement","ctx","getContext","indexOf","preferedWidth","outputCompression","compression","outputType","transform","drawImage","src","toDataURL","img2","ratio","readAsDataURL"],"mappings":"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","file":"goldenimage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"goldenimage\"] = factory();\n\telse\n\t\troot[\"goldenimage\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 602cbc16da6404abd8c4\n **/","const getOrientation = (file, callback) => {\n  var reader = new FileReader();\n  reader.onload = function(e) {\n\n    var view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xFFD8) return callback(-2);\n    var length = view.byteLength, offset = 2;\n    while (offset < length) {\n      var marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xFFE1) {\n        if (view.getUint32(offset += 2, false) != 0x45786966) return callback(-1);\n        var little = view.getUint16(offset += 6, false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        var tags = view.getUint16(offset, little);\n        offset += 2;\n        for (var i = 0; i < tags; i++)\n          if (view.getUint16(offset + (i * 12), little) == 0x0112)\n            return callback(view.getUint16(offset + (i * 12) + 8, little));\n      }\n      else if ((marker & 0xFF00) != 0xFF00) break;\n      else offset += view.getUint16(offset, false);\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nconst loadImage = (f, options = {}, callback) => {\n  getOrientation(f, (srcOrientation) => {\n    const reader = new FileReader();\n    reader.addEventListener('load', (file) => {\n      const img = new Image();\n      img.onload = () => {\n        let width = img.width;\n        let height = img.height;\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n\n        if ([5, 6, 7, 8].indexOf(srcOrientation) > -1) {\n          canvas.width = height;\n          canvas.height = width;\n        } else {\n          canvas.width = width;\n          canvas.height = height;\n        }\n        const preferedWidth = options.width || canvas.width;\n        const outputCompression = options.compression || 0.7;\n        let outputType = null\n        if (options.compression) {\n          outputType = 'image/jpeg';\n        }\n\n        switch (srcOrientation) {\n          case 2: ctx.transform(-1, 0, 0, 1, width, 0); break;\n          case 3: ctx.transform(-1, 0, 0, -1, width, height); break;\n          case 4: ctx.transform(1, 0, 0, -1, 0, height ); break;\n          case 5: ctx.transform(0, 1, 1, 0, 0, 0); break;\n          case 6: ctx.transform(0, 1, -1, 0, height, 0); break;\n          case 7: ctx.transform(0, -1, -1, 0, height, width); break;\n          case 8: ctx.transform(0, -1, 1, 0, 0, width); break;\n          default: ctx.transform(1, 0, 0, 1, 0, 0);\n        }\n\n        ctx.drawImage(img, 0, 0);\n        const src = canvas.toDataURL(outputType, outputCompression);\n\n        // Resizing\n        const img2 = new Image();\n        img2.src = src;\n        img2.onload = function() {\n          const ratio = preferedWidth / canvas.width;\n          canvas.width = preferedWidth;\n          canvas.height = canvas.height * ratio;\n          ctx.drawImage(img2, 0, 0, canvas.width, canvas.height);\n          callback(canvas.toDataURL(outputType, outputCompression));\n        }\n      }\n      img.src = file.target.result;\n    }, false);\n    reader.readAsDataURL(f);\n  });\n}\n\nexport default loadImage;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/goldenimage.js\n **/"],"sourceRoot":""}